import{r as x,_ as N,o as q,x as n,y as d,z as t,P as m,Y as H,K as b,O as w,aq as h,al as L,L as E,c as M,q as F,R as A,aV as K,Q as V,ac as B,C as P}from"./vue-vendor-Bsazo-x0.js";import{s as p,c as C}from"./index-DyNxxe0W.js";import{C as Q}from"./ConfirmModal-htOonKjA.js";import"./element-plus-CqiD73Lu.js";import"./vendor-Dr8jvgFu.js";const R={key:0,class:"fixed inset-0 z-50 h-full w-full overflow-y-auto bg-gray-900/60"},Y={class:"relative top-10 mx-auto w-full max-w-2xl rounded-lg bg-white shadow dark:bg-gray-800"},G={class:"flex items-center justify-between border-b px-6 py-4 dark:border-gray-700"},I={class:"text-lg font-semibold text-gray-900 dark:text-white"},J={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},W={class:"flex items-center space-x-2"},X={class:"flex items-center justify-end space-x-3 pt-2"},Z=["disabled"],tt={key:0,class:"-ml-1 mr-2 h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},et={key:1},rt={__name:"TutorialModal",props:{show:{type:Boolean,default:!1},tutorial:{type:Object,default:null}},emits:["close","saved"],setup(v,{emit:y}){const a=v,c=y,g=x(!1),r=N({title:"",content:"",category:"快速开始",sortOrder:0,isActive:!0});q(()=>a.show,u=>{u&&a.tutorial?(r.title=a.tutorial.title||"",r.content=a.tutorial.content||"",r.category=a.tutorial.category||"快速开始",r.sortOrder=a.tutorial.sortOrder||0,r.isActive=a.tutorial.isActive!==void 0?a.tutorial.isActive:!0):u&&!a.tutorial&&(r.title="",r.content="",r.category="快速开始",r.sortOrder=0,r.isActive=!0)},{immediate:!0});async function f(){var u,e;if(!r.title||!r.content){p("标题和内容不能为空","error");return}g.value=!0;try{a.tutorial?(await C.put(`/admin/tutorials/${a.tutorial.id}`,r),p("教程更新成功","success")):(await C.post("/admin/tutorials",r),p("教程创建成功","success")),c("saved"),c("close")}catch(i){p(((e=(u=i.response)==null?void 0:u.data)==null?void 0:e.message)||"操作失败","error")}finally{g.value=!1}}return(u,e)=>v.show?(d(),n("div",R,[t("div",Y,[t("div",G,[t("h3",I,m(v.tutorial?"编辑教程":"创建教程"),1),t("button",{class:"text-gray-400 hover:text-gray-600",onClick:e[0]||(e[0]=i=>c("close"))},e[7]||(e[7]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M6 18L18 6M6 6l12 12","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)]))]),t("form",{class:"space-y-4 px-6 py-5",onSubmit:H(f,["prevent"])},[t("div",null,[e[8]||(e[8]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},[w(" 标题 "),t("span",{class:"text-red-500"},"*")],-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>r.title=i),class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",placeholder:"请输入标题",required:""},null,512),[[h,r.title,void 0,{trim:!0}]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"},[w(" 内容 "),t("span",{class:"text-red-500"},"*")],-1)),b(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>r.content=i),class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",placeholder:"请输入内容（支持Markdown）",required:"",rows:"10"},null,512),[[h,r.content,void 0,{trim:!0}]])]),t("div",J,[t("div",null,[e[10]||(e[10]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 分类 ",-1)),b(t("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>r.category=i),class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",placeholder:"如：快速开始、高级用法"},null,512),[[h,r.category,void 0,{trim:!0}]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 排序顺序 ",-1)),b(t("input",{"onUpdate:modelValue":e[4]||(e[4]=i=>r.sortOrder=i),class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",min:"0",type:"number"},null,512),[[h,r.sortOrder,void 0,{number:!0}]]),e[12]||(e[12]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"数字越小越靠前",-1))])]),t("div",W,[b(t("input",{id:"isActive","onUpdate:modelValue":e[5]||(e[5]=i=>r.isActive=i),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",type:"checkbox"},null,512),[[L,r.isActive]]),e[13]||(e[13]=t("label",{class:"text-sm text-gray-700 dark:text-gray-300",for:"isActive"},"启用",-1))]),t("div",X,[t("button",{class:"rounded-md border px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-700",type:"button",onClick:e[6]||(e[6]=i=>c("close"))}," 取消 "),t("button",{class:"inline-flex items-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-blue-700 disabled:opacity-50",disabled:g.value,type:"submit"},[g.value?(d(),n("svg",tt,e[14]||(e[14]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z",fill:"currentColor"},null,-1)]))):E("",!0),w(" "+m(v.tutorial?"更新":"创建"),1)],8,Z)])],32)])])):(d(),n("div",et))}},st={class:"space-y-6"},ot={class:"sm:flex sm:items-center"},at={class:"mt-4 space-x-3 sm:ml-16 sm:mt-0 sm:flex-none"},lt=["disabled"],it=["disabled"],nt={class:"flex items-center space-x-2"},dt=["value"],ut={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ct={key:0,class:"p-8 text-center"},xt={key:1,class:"p-8 text-center"},gt={key:2,class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},mt={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},yt={class:"whitespace-nowrap px-6 py-4"},pt={class:"text-sm font-medium text-gray-900 dark:text-white"},ft={class:"whitespace-nowrap px-6 py-4"},bt={class:"inline-flex rounded-full bg-gray-100 px-2 py-1 text-xs font-semibold text-gray-800 dark:bg-gray-700 dark:text-gray-300"},vt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},kt={class:"whitespace-nowrap px-6 py-4"},wt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},ht={class:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},Ct=["onClick"],_t=["onClick"],Tt={__name:"TutorialManagementView",setup(v){const y=x(!0),a=x([]),c=x(""),g=x(!1),r=x(!1),f=x(!1),u=x(null),e=x(null),i=M(()=>{const o=new Set(a.value.map(s=>s.category).filter(Boolean));return Array.from(o).sort()}),_=M(()=>{let o=a.value;return c.value&&(o=o.filter(s=>s.category===c.value)),o});function T(o){return o?new Date(o).toLocaleString("zh-CN"):"-"}async function k(){y.value=!0;try{const o=await C.get("/admin/tutorials");o.success?a.value=o.data||[]:a.value=[]}catch{p("加载教程失败","error"),a.value=[]}finally{y.value=!1}}function O(o){u.value=o,r.value=!0}function j(o){e.value=o,f.value=!0}async function z(){if(e.value)try{await C.delete(`/admin/tutorials/${e.value.id}`),p("删除成功","success"),f.value=!1,e.value=null,await k()}catch{p("删除失败","error")}}function D(){g.value=!1,r.value=!1,u.value=null}function S(){k()}return F(()=>{k()}),(o,s)=>{var $;return d(),n("div",st,[t("div",ot,[s[5]||(s[5]=t("div",{class:"sm:flex-auto"},[t("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-white"},"教程管理"),t("p",{class:"mt-2 text-sm text-gray-700 dark:text-gray-300"},"管理系统教程")],-1)),t("div",at,[t("button",{class:"inline-flex items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:y.value,onClick:s[0]||(s[0]=l=>g.value=!0)},s[3]||(s[3]=[t("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 4v16m8-8H4","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1),w(" 创建教程 ",-1)]),8,lt),t("button",{class:"inline-flex items-center justify-center rounded-md border border-transparent bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",disabled:y.value,onClick:k},s[4]||(s[4]=[t("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1),w(" 刷新 ",-1)]),8,it)])]),t("div",nt,[s[7]||(s[7]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"分类筛选：",-1)),b(t("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>c.value=l),class:"rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",onChange:k},[s[6]||(s[6]=t("option",{value:""},"全部",-1)),(d(!0),n(V,null,B(i.value,l=>(d(),n("option",{key:l,value:l},m(l),9,dt))),128))],544),[[K,c.value]])]),t("div",ut,[y.value?(d(),n("div",ct,s[8]||(s[8]=[t("svg",{class:"mx-auto h-8 w-8 animate-spin text-blue-500",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})],-1),t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"加载中...",-1)]))):_.value.length===0?(d(),n("div",xt,s[9]||(s[9]=[t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"暂无教程",-1)]))):(d(),n("table",gt,[s[10]||(s[10]=t("thead",{class:"bg-gray-50 dark:bg-gray-900"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," 标题 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," 分类 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," 排序 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," 状态 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," 创建时间 "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",scope:"col"}," 操作 ")])],-1)),t("tbody",mt,[(d(!0),n(V,null,B(_.value,l=>(d(),n("tr",{key:l.id},[t("td",yt,[t("span",pt,m(l.title),1)]),t("td",ft,[t("span",bt,m(l.category),1)]),t("td",vt,m(l.sortOrder),1),t("td",kt,[t("span",{class:P(["inline-flex rounded-full px-2 py-1 text-xs font-semibold",l.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"])},m(l.isActive?"启用":"禁用"),3)]),t("td",wt,m(T(l.createdAt)),1),t("td",ht,[t("button",{class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",onClick:U=>O(l)}," 编辑 ",8,Ct),t("button",{class:"ml-4 text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",onClick:U=>j(l)}," 删除 ",8,_t)])]))),128))])]))]),A(rt,{show:g.value||r.value,tutorial:u.value,onClose:D,onSaved:S},null,8,["show","tutorial"]),A(Q,{"confirm-class":"bg-red-600 hover:bg-red-700","confirm-text":"删除",message:`确定要删除教程「${($=e.value)==null?void 0:$.title}」吗？`,show:f.value,title:"确认删除",onCancel:s[2]||(s[2]=l=>f.value=!1),onConfirm:z},null,8,["message","show"])])}}};export{Tt as default};
